# -- Environment identifier (development, staging, production)
environment: production

# -- Number of replicas for the StatefulSet.
# For an app with an embedded DB like Sled, this should almost always be 1.
replicaCount: 1

image:
  # -- The container image repository
  repository: grekodocker/autolab-api
  # -- The container image tag (git short hash, set via --set image.tag=xxx)
  tag: ""
  # -- The image pull policy
  pullPolicy: IfNotPresent

# -- The name of the Kubernetes secret holding keys (SECRET_KEY, SECRET_KEY_LICENSE, admins.txt)
secretName: autolab-api-secret

# -- Secret configuration
secret:
  # -- Whether to create the secret (set to false if managing secrets externally)
  create: true
  # -- JWT secret key (base64 encoded automatically). Leave empty to auto-generate.
  secretKey: ""
  # -- License JWT secret key (base64 encoded automatically). Leave empty to auto-generate.
  secretKeyLicense: ""
  # -- Admin emails/usernames (plain text, will be base64 encoded). Leave empty for default.
  admins: ""

# -- Resource limits and requests for the container
resources:
  limits:
    cpu: "500m"
    memory: "512Mi"
  requests:
    cpu: "100m"
    memory: "256Mi"

# -- Persistence configuration for the Volume Claim Template
persistence:
  # -- The size of the PersistentVolumeClaim
  size: 1Gi
  # -- (Optional) The StorageClass to use.
  # If empty or "", the cluster's default StorageClass will be used.
  storageClassName: ""

# -----------------------------------------------------------------
# New section for the PDF Generator service
# -----------------------------------------------------------------
pdfgen:
  # -- Number of replicas for the pdfgen Deployment
  replicaCount: 1
  image:
    # -- The container image repository
    repository: grekodocker/autolab-pdf
    # -- The container image tag (git short hash, set via --set pdfgen.image.tag=xxx)
    tag: ""
    # -- The image pull policy
    pullPolicy: IfNotPresent
  # -- Resource limits and requests for the pdfgen container
  resources:
    limits:
      cpu: "500m"
      memory: "512Mi"
    requests:
      cpu: "100m"
      memory: "256Mi"

ingress:
  # -- Enable or disable the Ingress resource
  enabled: true
  # -- The IngressClass to use
  className: "traefik"
  # -- Annotations for the Ingress controller (e.g., cert-manager)
  annotations:
    kubernetes.io/ingress.class: traefik
    cert-manager.io/cluster-issuer: letsencrypt-prod
  # -- The hostname for the Ingress
  host: autolab.dcommunity.space
  # -- TLS configuration
  tls:
    # -- Enable TLS for the Ingress
    enabled: true
    # -- The name of the secret to store the certificate.
    # cert-manager will create this secret.
    secretName: autolab-cert

# -----------------------------------------------------------------
# Backup configuration
# -----------------------------------------------------------------
backup:
  # -- Enable or disable automated backups
  enabled: true
  # -- Cron schedule for backups (in UTC)
  # "0 23 * * *" = 11 PM UTC = 1 AM/2 AM Kyiv (depending on DST)
  # "0 0 * * *" = Midnight UTC = 2 AM/3 AM Kyiv (depending on DST)
  schedule: "0 0 * * *"
  # -- Timezone for the backup job (used for logging timestamps)
  timezone: "Europe/Kyiv"
  # -- Number of backup files to retain (older backups are automatically deleted)
  retention: 10
  # -- Size of the backup PersistentVolumeClaim
  storageSize: 5Gi
  # -- (Optional) StorageClass for backup volume. If empty, uses cluster default.
  storageClassName: ""
  # -- Container image for running backups (needs tar, gzip, date, basic shell)
  image: "busybox:1.36"
  # -- Number of successful job runs to keep in history
  successfulJobsHistoryLimit: 3
  # -- Number of failed job runs to keep in history
  failedJobsHistoryLimit: 3
  # -- Resource limits for the backup job
  resources:
    limits:
      cpu: "200m"
      memory: "256Mi"
    requests:
      cpu: "50m"
      memory: "128Mi"
